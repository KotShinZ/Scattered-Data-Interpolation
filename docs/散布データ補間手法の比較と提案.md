

# **散布データにおける滑らかな曲面再構成：希少データに対する高度な補間手法の包括的比較と数理的解析**

## **1\. 序論：散布データ補間問題の数理的・実用的背景**

現代の科学技術計算、地球統計学、コンピュータグラフィックス、そして気象学など多岐にわたる分野において、不規則に配置された離散的なデータ点（散布データ）から、定義域全体を覆う連続かつ滑らかな関数を再構成する「散布データ補間（Scattered Data Interpolation）」は、極めて根源的かつ困難な課題として存在しています 1。特に、データ点が空間的に疎（sparse）である場合、あるいはデータの欠損領域が広大である場合、その未知領域をどのように「埋める」かという問題は、単なる数値計算の枠を超え、対象となる物理現象や地理的特性の妥当性を左右する重要な要素となります。

本報告書は、特に「少ないデータ点数」かつ「滑らかさ（Smoothness）」が要求される状況に焦点を当て、既存の単純な手法（線形補間や最近傍補間）が抱える限界を克服するための高度なアルゴリズム群を網羅的に解析するものです。線形補間が生成する $C^0$ 連続（位置のみ連続で、傾きが不連続）な曲面は、視覚的な美しさを欠くだけでなく、勾配情報を必要とする物理シミュレーションや地形解析においては不適切であることが知られています 3。したがって、本稿では少なくとも $C^1$（接平面連続）以上の滑らかさを保証し、かつ疎なデータ特有のアーティファクト（不自然な振動や過度な平滑化）を抑制できる手法群——修正シェパード法、放射基底関数（RBF）、自然近傍法（Natural Neighbor）、移動最小二乗法（MLS）、多段階Bスプライン（MBA）、そしてパウエル・サビン（Powell-Sabin）スプラインなど——について、その数学的基礎、アルゴリズムの挙動、そして実装上の特性を詳述します。

### **1.1. 補間と近似の理論的境界**

議論を進める前に、数学的な定義としての「補間（Interpolation）」と「近似（Approximation）」の峻別を行う必要があります。補間とは、再構成された曲面 $S(\\mathbf{x})$ が、全ての観測点 $\\mathbf{x}\_i$ において観測値 $f\_i$ を正確に通ること（$S(\\mathbf{x}\_i) \= f\_i$）を要請します 4。一方、近似は、観測点近傍を通過することを許容しつつ、曲面全体のエネルギー最小化や滑らかさを優先するアプローチです。  
データが極めて少ない場合、一般的には貴重な観測情報を「真」として尊重する補間アプローチが好まれます。しかし、データにノイズが含まれる場合、あるいはデータ配置が極端に偏っている場合、厳密な補間はルンゲ現象のような激しい振動（オーバーシュート/アンダーシュート）を引き起こすリスクがあります 5。本報告書では、このトレードオフを考慮しつつ、各手法がどのようにデータの忠実性と曲面の正則性を両立させているかを分析します。

### **1.2. 疎なデータ（Sparse Data）がもたらす特異な課題**

「データが少ない」という制約は、アルゴリズムに対して以下のような深刻な課題を突きつけます。

1. **大域的空隙の架橋:** データ点間の距離が離れている場合、局所的な情報（隣接点の値や勾配）だけでは、その間の空間の挙動を決定することが困難になります。ここで、アルゴリズムがどのような「張力（Tension）」や「曲率最小化」のモデルを仮定するかが、結果の品質を決定づけます 6。  
2. **三角形分割の劣化:** ドロネー三角形分割（Delaunay Triangulation）に基づく手法では、データが疎であると、定義域の境界付近やデータ密度の急変部において「スリバー（Sliver）」と呼ばれる細長い三角形が生成されやすくなります。これは数値計算上の不安定性や、勾配推定の著しい劣化を招きます 7。  
3. **特徴の喪失と平滑化:** 少ないサンプリング数は、高周波成分（急峻なピークや谷）の情報欠落を意味します。滑らかさを追求するあまり、本来存在するはずの局所的な特徴が過度に平滑化され、物理的にあり得ない平坦な地形が生成されるリスクがあります 2。

本報告書では、これらの課題に対し、各手法がどのような数理的アプローチで解決を図っているのか、そのメカニズムを深層的に掘り下げていきます。

---

## **2\. 決定論的距離逆比加重法とその拡張：修正シェパード法**

最も直感的かつ古典的なアプローチである距離逆比加重法（Inverse Distance Weighting: IDW）は、未知点における値を、既知点からの距離の逆数に応じた加重平均として算出します。しかし、疎なデータに対する滑らかな補間という観点からは、古典的IDWには致命的な欠陥が存在します。

### **2.1. 古典的IDWの限界とアーティファクト**

古典的IDWの重み関数 $w\_i(\\mathbf{x}) \= d(\\mathbf{x}, \\mathbf{x}\_i)^{-p}$ （通常 $p=2$）は、全データ点の影響を受ける大域的な手法、あるいは探索半径を設けた局所的な手法として実装されます 9。しかし、この単純な定式化は以下の二つの視覚的・数学的問題を引き起こします。

* **ブルズアイ効果（Bull's-Eye Effect）:** データ点の周囲に、等高線が同心円状に形成される現象です。これは、補間値が最も近いデータ点のみに強く支配され、データ点間の傾向（トレンド）を無視して極値へと急速に収束するために発生します。データが疎であるほど、この孤立した「島」のような形状が目立ち、地形や物理場の表現として不自然になります 10。  
* **フラットスポット（Flat Spots）:** 重みパラメータ $p \> 1$ の場合、データ点 $\\mathbf{x}\_i$ における補間曲面の導関数（勾配）はゼロになります。つまり、全てのデータ点が極値（頂点や底）のように扱われ、データ点を通過するたびに曲面が水平になる「平坦化」が生じます 12。これにより、斜面にあるデータ点であっても、そこで一度平らになってしまうため、階段状の地形が生成されてしまいます。

### **2.2. フランケ・ニールソンによる修正二次シェパード法（Modified Quadratic Shepard's Method）**

これらの問題を解決し、疎なデータに対しても $C^1$ 級の滑らかさと自然な形状を提供するために開発されたのが、FrankeとNielson（1980）、およびRenka（1988）による修正シェパード法です 10。この手法は、単純な重み付き平均ではなく、**局所的な最小二乗近似**を導入することで、データの「傾向（トレンド）」を捉える能力を劇的に向上させています。

#### **2.2.1. アルゴリズムの数理的構造**

この手法は、大きく二つの段階（Two-Stage Process）で構成されています。

第一段階：局所的な二次関数の構築（Nodal Function Construction）  
まず、各データ点 $\\mathbf{x}\_k$ に対して、その点を通る局所的な近似関数 $Q\_k(\\mathbf{x})$ を構築します。古典的IDWがデータ点の「値」のみを使用するのに対し、修正法ではその点周辺の「形状」を推定します 11。  
具体的には、データ点 $\\mathbf{x}\_k$ の近傍にある $N\_q$ 個の点（通常は5〜13個程度）を用い、以下の二次多項式を重み付き最小二乗法で当てはめます。

$$Q\_k(x, y) \= c\_{k,1} \+ c\_{k,2}x \+ c\_{k,3}y \+ c\_{k,4}x^2 \+ c\_{k,5}xy \+ c\_{k,6}y^2$$

この二次関数 $Q\_k$ は、データ点 $\\mathbf{x}\_k$ における局所的な勾配（傾き）と曲率を捉えています。これにより、データ点上で勾配がゼロになるというIDWの制約が撤廃され、斜面や曲面の一部としての自然な振る舞いが再現可能になります 15。  
第二段階：二次関数の重み付きブレンド  
最終的な補間値 $F(\\mathbf{x})$ は、スカラー値の加重平均ではなく、第一段階で求めた局所二次関数 $Q\_k(\\mathbf{x})$ の加重平均として計算されます。

$$F(\\mathbf{x}) \= \\frac{\\sum\_{k=1}^N W\_k(\\mathbf{x}) Q\_k(\\mathbf{x})}{\\sum\_{k=1}^N W\_k(\\mathbf{x})}$$

ここで、重み関数 $W\_k(\\mathbf{x})$ にも工夫が施されています。古典的な全点参照を避け、計算効率と局所性を高めるために、ある影響半径 $R\_w$ 以内の点のみが非ゼロの重みを持つようなコンパクトな台（Compact Support）を持つ重み関数が採用されます 16。

$$W\_k(\\mathbf{x}) \= \\left^2$$

ここで $(z)\_+$ は $z\>0$ で $z$、それ以外で $0$ を返す関数です。

#### **2.2.2. 疎なデータに対する優位性と限界**

修正シェパード法は、疎なデータ補間において以下の点で優れています。

1. **トレンドの推定:** 局所的な二次関数を用いることで、データ点間の空白領域に対しても、その勾配情報を延長して補間を行います。これにより、データがない領域でも不自然に値が減衰することなく、もっともらしい推移が生成されます 18。  
2. **ブルズアイの消失:** 二次曲面をブレンドするため、等高線は同心円にならず、楕円や双曲線など、より複雑で自然な地形表現が可能になります 19。  
3. **計算コスト:** 局所的な近傍探索に基づくため、数千点程度までのデータであれば極めて高速に動作します。

一方で、限界も存在します。データ点数が極端に少ない場合（例えば全データが5点未満など）、局所的な二次曲面を決定するための自由度が不足し（二次式の係数は6個必要）、最小二乗法が不安定になる、あるいは平面近似に退化する可能性があります 20。また、二次関数による外挿は、データ範囲外（Extrapolation）において値が急速に発散するリスクがあるため、凸包（Convex Hull）外での使用には注意が必要です 14。

---

## **3\. 幾何学的アプローチ：自然近傍法（Natural Neighbor Interpolation）**

ボロノイ図（Voronoi Diagram）という計算幾何学の構造に基づく自然近傍法（Sibson法とも呼ばれる）は、パラメータ調整が不要で、かつデータの密度分布に自動的に適応する堅牢な手法として、地理情報システム（GIS）や有限要素法の分野で高く評価されています 21。

### **3.1. 「領域の奪い合い」による重み付け原理**

自然近傍法の核心は、補間したい点 $\\mathbf{x}$ を既存のボロノイ図に「仮想的に挿入」した際に生じる幾何学的変化にあります。

1. **ボロノイ分割:** まず、既存のデータ点群 $\\mathbf{X} \= \\{\\mathbf{x}\_1, \\dots, \\mathbf{x}\_N\\}$ によって定義域をボロノイ領域（各データ点が最も近い領域）に分割します。  
2. **仮想挿入と領域の収奪:** 未知の点 $\\mathbf{x}$ をこの図に追加すると、$\\mathbf{x}$ は周囲の既存のボロノイ領域から自身の領域（テリトリー）を「奪い取り」ます。  
3. 重みの決定: 点 $\\mathbf{x}$ におけるデータ点 $\\mathbf{x}\_i$ の重み $w\_i(\\mathbf{x})$ は、$\\mathbf{x}$ が生成した新しいボロノイ領域のうち、元々 $\\mathbf{x}\_i$ の領域であった部分の面積（または体積）の比率として定義されます 21。

   $$w\_i(\\mathbf{x}) \= \\frac{Area(Cell\_i \\cap NewCell\_x)}{Area(NewCell\_x)}$$

この定義により、重みは距離だけでなく「方向」や「配置」を考慮したものになります。例えば、データ点が一直線上に並んでいる場合や、密度が偏っている場合でも、ボロノイ領域の形状がそれを反映するため、IDWのような方向バイアスが生じません。

### **3.2. 滑らかさの数理：Sibson重みとLaplace重み**

自然近傍法には、重みの計算方法によって主に二つのバリエーションが存在し、それぞれ滑らかさの特性が異なります。

#### **3.2.1. Sibson重み（$C^1$ except at nodes）**

Robin Sibsonが提案したオリジナルの重み（面積比）を用いた場合、生成される曲面はデータ点以外の場所で $C^1$ 連続（滑らか）となります。しかし、データ点 $\\mathbf{x}\_i$ の真上においては、曲面は $C^0$ 連続（円錐の頂点のように尖った状態）となり、勾配が不連続になります 22。これは、データ点に近づくにつれて、その点の影響力が支配的になりすぎるためです。

#### **3.2.2. Laplace重み**

一方、面積ではなく、ボロノイ領域の境界線（Voronoi Edge）の長さと距離に基づく「Laplace重み（非Sibson型）」も存在します。

$$w\_i^{Laplace}(\\mathbf{x}) \= \\frac{l\_i(\\mathbf{x})}{d(\\mathbf{x}, \\mathbf{x}\_i)}$$

ここで $l\_i(\\mathbf{x})$ は点 $\\mathbf{x}$ と $\\mathbf{x}\_i$ のボロノイ境界の長さです。Laplace重みは計算が若干単純ですが、Sibson重みと同様にデータ点上で勾配の不連続性を持ちます 25。

#### **3.2.3. 完全な滑らかさへの拡張（$C^1$ Everywhere）**

データ点上でも滑らかな（$C^1$）曲面を得るために、SibsonやFarin、Hiyoshiらは、勾配情報を組み込んだ拡張手法を提案しています。これは、各データ点における勾配ベクトルを推定し、それを基に重み付けを行うことで、データ点を通過する際も滑らかに接平面が変化するように強制するものです 26。この「幾何学的（Geometric）」あるいは「勾配付き」自然近傍法を採用することで、疎なデータであっても物理的に妥当な滑らかな場を再構成することが可能になります。

### **3.3. 離散Sibson補間（Discrete Sibson Interpolation）の実装**

自然近傍法の最大の欠点は、新しい点を挿入するたびにボロノイ図を再計算（あるいは局所更新）する必要があり、計算幾何学的な実装難易度が高いことです。これに対し、近年（特にGPU活用において）注目されているのが「離散Sibson補間」です 28。  
この手法では、正確なボロノイ図を計算する代わりに、高解像度のグリッド（ラスタ）上でボロノイ図を近似的に描画します。各ピクセルがどの母点に属するかを判定（離散ボロノイ図）し、補間点周辺のピクセルをスキャンして「面積」をピクセル数としてカウントすることで重みを算出します。これにより、複雑な幾何計算を回避し、Pythonのnumpyや画像処理ライブラリを用いて高速に自然近傍補間を実行することが可能になります 29。

### **3.4. 疎なデータに対する適合性**

自然近傍法は、疎なデータに対して以下の理由から極めて強力な選択肢となります。

* **パラメータ不要:** 探索半径や近傍点数を指定する必要がなく、データ密度が低い場所では自動的に広い範囲から、高い場所では狭い範囲から近傍点を選び出します。これはデータ密度が不均一な場合に決定的です 21。  
* **凸包内での有界性:** 補間値は常に隣接するデータ点の値の範囲内に収まる（凸結合である）ため、スプライン補間のようなオーバーシュート（異常な値の跳ね上がり）が発生しません。これは地形や濃度の補間において安全性を保証します 21。

---

## **4\. 放射基底関数（Radial Basis Functions: RBF）とその応用**

放射基底関数（RBF）法は、現代の散布データ補間において、最も滑らかで高精度な結果をもたらす手法の一つとして認識されています。特に、データ点数が少なく（数百〜数千点）、かつ定義域全体にわたって張力のある滑らかな曲面を生成したい場合、RBFは最強の候補となります。

### **4.1. 大域的補間の数理モデル**

RBF補間は、各データ点 $\\mathbf{x}\_i$ を中心とする放射対称な基底関数 $\\phi(r)$ の線形結合として曲面 $S(\\mathbf{x})$ を表現します 31。

$$S(\\mathbf{x}) \= \\sum\_{i=1}^N \\lambda\_i \\phi(\\|\\mathbf{x} \- \\mathbf{x}\_i\\|) \+ P(\\mathbf{x})$$

ここで、$\\|\\mathbf{x} \- \\mathbf{x}\_i\\|$ はユークリッド距離、$P(\\mathbf{x})$ はデータの傾向を捉えるための低次多項式項（線形または定数）です。係数 $\\lambda\_i$ は、補間条件 $S(\\mathbf{x}\_i) \= f\_i$ を満たすように、$N \\times N$ の線形方程式系を解くことで決定されます。  
この手法が「大域的（Global）」と呼ばれるのは、ある一点の補間値を決定するために、理論上すべてのデータ点の情報が（距離に応じて減衰しつつも）寄与するためです。疎なデータにおいては、この大域的性質が、データ点間の広大な空白領域を滑らかに橋渡しする役割を果たします。

### **4.2. 基底関数（カーネル）の選択と形状パラメータ**

結果の滑らかさと挙動は、基底関数 $\\phi(r)$ の選択に完全に依存します。

| 基底関数名 | 数式 ϕ(r) | 特性 | 疎なデータへの適合性 |
| :---- | :---- | :---- | :---- |
| **Thin Plate Spline (TPS)** | $r^2 \\ln(r)$ | $C^2$ 級（原点除き）。物理的な薄板の曲げエネルギーを最小化。 | **最適**。パラメータ調整不要で、データ点間を「ピンと張った」ような自然な曲面で繋ぐ 15。 |
| **Multiquadric (MQ)** | $\\sqrt{r^2 \+ \\epsilon^2}$ | $C^\\infty$ 級。非常に滑らかで精度が高い。 | 非常に高いが、形状パラメータ $\\epsilon$ の調整が必要。 |
| **Inverse Multiquadric** | $1/\\sqrt{r^2 \+ \\epsilon^2}$ | $C^\\infty$ 級。 | 局所性が強く、疎なデータではピークが孤立しやすい。 |
| **Gaussian** | $e^{-(\\epsilon r)^2}$ | $C^\\infty$ 級。正定値性が保証される。 | $\\epsilon$ 次第で、平坦すぎるかスパイク状になるリスクがある。 |

疎なデータ、特に地形や物理場の再構成には、**Thin Plate Spline (TPS)** が推奨されます。TPSは「形状パラメータ $\\epsilon$」を必要としないため、パラメータチューニングの難しさから解放され、かつ物理的に自然な（エネルギー最小の）滑らかさを提供します 33。一方、Multiquadricは精度面でTPSを上回ることがありますが、$\\epsilon$ の値がデータ密度に依存するため、不均一な疎データでは最適な $\\epsilon$ の決定が困難な場合があります 34。

### **4.3. RBF-FD：疎なデータ上での偏微分方程式解法への応用**

RBFの強力な特性は、単なる補間にとどまりません。近年、疎なデータ点上で流体解析や熱伝導などの偏微分方程式（PDE）を解くための手法として、\*\*RBF生成有限差分法（RBF-FD: Radial Basis Function-generated Finite Differences）\*\*が急速に発展しています 32。

通常、有限差分法（FD）は格子状のグリッドを必要としますが、RBF-FDでは散布点群の上で、各点ごとの「局所的なRBF補間」を行い、そのRBFを解析的に微分することで微分演算子（ラプラシアンなど）の重みを決定します。

* **ポリハーモニック・スプライン（PHS）の活用:** 従来、RBFには形状パラメータ $\\epsilon$ の調整問題がありましたが、RBF-FDにおいては、$\\phi(r) \= r^3, r^5, \\dots$ といった奇数次のポリハーモニック・スプライン（PHS）と多項式項を組み合わせることで、パラメータフリーかつ高次精度で微分値を近似できることが示されています 37。  
* この技術は、データが疎で不規則な配置であっても、その上で直接物理シミュレーションを行ったり、勾配場（Gradient Field）を高精度に推定したりすることを可能にします。補間曲面の「滑らかさ」が、微分可能性という数理的意味で保証される強力な証左です。

---

## **5\. 移動最小二乗法（Moving Least Squares: MLS）**

移動最小二乗法（MLS）は、主に点群処理（Point Cloud Processing）やメッシュレス法（Meshfree Methods）で用いられる手法ですが、高品質な補間手法としても機能します。MLSは、評価点ごとに局所的な重み付き最小二乗問題を定義し、その解として曲面を陰的に構成します 4。

### **5.1. 特異重み関数による「補間」の実現**

通常、最小二乗法はデータ点を通らない「近似」曲面を生成します（ノイズ除去目的）。しかし、疎なデータ補間において「既知の点は必ず通る」ことが要求される場合、\*\*特異重み関数（Singular Weight Function）\*\*を導入することでMLSを完全な補間法（Interpolating MLS: IMLS）に変形できます 40。

通常の重み関数（ガウス関数など）の代わりに、距離 $r \\to 0$ で $w(r) \\to \\infty$ となる関数（例えば $w(r) \= 1/r^2$ や $1/r^4$）を使用します。

$$\\min\_{\\mathbf{a}(\\mathbf{x})} \\sum\_{i=1}^N \\frac{1}{\\|\\mathbf{x} \- \\mathbf{x}\_i\\|^2} (P(\\mathbf{x}, \\mathbf{x}\_i) \- f\_i)^2$$

この定式化では、評価点 $\\mathbf{x}$ がデータ点 $\\mathbf{x}\_i$ に近づくと重みが無限大になるため、誤差項を有限に保つためには、生成される曲面 $P(\\mathbf{x})$ がデータ値 $f\_i$ に収束せざるを得なくなります。これにより、滑らかさを維持したまま、厳密な補間が実現されます 42。

### **5.2. 滑らかさと多様体再構成**

MLSによって生成される曲面は、使用する重み関数の滑らかさを継承します。ガウス関数やスプライン関数を重みに用いれば、$C^\\infty$ または $C^2$ 級の極めて滑らかな曲面が得られます。  
また、MLSは「投影（Projection）」という概念を用いて、ノイズの多い点群から滑らかな多様体（Manifold）を再構成する能力に長けています。データが疎であっても、局所的に平面や二次曲面を当てはめながら移動していくため、位相的な破綻（穴や自己交差）が起きにくいという特徴があります 43。

---

## **6\. スプラインベースの高度なアプローチ**

多項式スプラインは滑らかさの代名詞ですが、通常のBスプラインは格子状データを前提とします。散布データに対してスプラインの利点を活かすために、階層的なアプローチや三角形分割を用いた特殊なスプラインが開発されています。

### **6.1. 多段階Bスプライン（Multilevel B-Splines: MBA）**

Leeら（1997）によって提案されたMBA法は、疎なデータと密なデータが混在する状況において、計算速度と滑らかさを両立させる画期的なアルゴリズムです 1。

#### **6.1.1. 階層的（Coarse-to-Fine）アルゴリズム**

MBAは、解像度の異なるBスプライン格子の階層（Hierarchy）を利用します。

1. **粗い格子による大域的傾向の把握:** 最初に、非常に粗い制御格子（例えば $4 \\times 4$）でBスプライン曲面をデータに当てはめます。この段階では、格子間隔が広いため、疎なデータ間の大きな隙間が滑らかなBスプライン曲面によって自然に埋められます。これが大域的なトレンドとなります。  
2. **残差の計算と詳細化:** 次に、元のデータと現在の曲面との差分（残差）を計算します。この残差に対して、より細かい格子（例えば $8 \\times 8$）を用いて再度Bスプライン近似を行います。  
3. **階層の合成:** これを十分な精度が出るまで（あるいは格子の細かさがデータ間隔に達するまで）繰り返します。最終的な曲面は、全階層の曲面の和となります 46。

#### **6.1.2. 疎なデータに対する挙動**

疎なデータに対してMBAが優れているのは、データが存在しない領域（Gap）の挙動が、階層の初期段階にある「粗い格子」によって支配される点です。これにより、データがない場所でも暴れることなく、滑らかで安定した曲面が生成されます。一方で、データが密集している場所では細かい格子が機能し、詳細な特徴を捉えます。結果として、$C^2$ 級の連続性が保証された高品質な曲面が得られます 47。計算コストも $O(N)$ に近く、非常に高速です。

### **6.2. 三角形分割上のスプライン：Clough-TocherとPowell-Sabin**

散布データをドロネー三角形分割した上で、各三角形内部を多項式で定義する方法です。単なる線形補間（$C^0$）を超え、$C^1$ 接続を実現するために、三角形をさらに細分化（Split）する特殊な技法が用いられます。

* **Clough-Tocher分割（CT法）:** 各三角形を重心で3つの小三角形に分割し、それぞれの領域で3次多項式（Cubic）を定義します。これにより、隣接する三角形間での値と法線ベクトルの連続性（$C^1$）を保証します 49。有限要素法やSciPy (CloughTocher2DInterpolator) で標準的に採用されており、有界で安定した滑らかさを提供します。  
* **Powell-Sabin分割（PS法）:** より高度な手法として、三角形を6つ（または12つ）の小三角形に分割し、2次多項式（Quadratic）を用いるPowell-Sabinスプラインがあります 7。CT法と比較して、PS法は「2次式」で $C^1$ を実現するため、曲率の変動が穏やかで、より自然な形状（Shape Preserving）を保ちやすいという数学的利点があります。また、数値計算上の行列構造が安定的であるため、偏微分方程式の解法としても優れています 52。

---

## **7\. 比較評価と推奨事項の統合**

以上の分析に基づき、疎なデータに対する滑らかな補間手法の特性を比較・統合し、具体的な推奨事項を提示します。

### **7.1. 手法別比較マトリックス**

| 手法名 | 滑らかさの等級 | 疎データへの適合性 | 外挿（定義域外） | 計算コスト | 特記事項・アーティファクト |
| :---- | :---- | :---- | :---- | :---- | :---- |
| **修正シェパード法** | $C^1$ | **良** (局所トレンド反映) | 不安定 (定数/発散) | 低 | ブルズアイは抑制されるが、パラメータ調整が必要。 |
| **自然近傍法 (Sibson)** | $C^1$ (点上除く) | **優** (密度適応・有界) | 不可 (凸包内のみ) | 中 | オーバーシュートなし。データ分布に完全に依存。 |
| **RBF (Thin Plate Spline)** | $C^2$ / $C^\\infty$ | **優** (大域的架橋) | 可能だが危険 | 高 (点数増大時) | 物理的に最も自然な「曲げ」。パラメータ不要で最強。 |
| **多段階Bスプライン (MBA)** | $C^2$ | **良** (階層的穴埋め) | 良 (格子範囲内) | 極低 | 高速。格子設定により詳細度が変わる。 |
| **Clough-Tocher / PS** | $C^1$ | **可** (三角形品質に依存) | 不可 (凸包内のみ) | 中 | FEM等との親和性高。スリバー（細長い三角形）に弱い。 |

### **7.2. シナリオ別推奨手法**

ユーザーの最終的な要望である「提案手法の一覧」として、以下のランキングと選定基準を提示します。

#### **【最推奨】放射基底関数（特に Thin Plate Spline）**

* **理由:** 物理的な「薄板の曲げエネルギー」を最小化するという数学的性質により、データ点間の広い空白領域を最も自然かつ滑らかに繋ぐことができます。特に、データ点数が極端に少ない（数十点以下）場合でも、全体として破綻のない美しい曲面を生成します。  
* **実装:** Pythonの scipy.interpolate.Rbf (function='thin\_plate') で容易に利用可能です。パラメータ $\\epsilon$ の調整が不要である点も、実務上の大きな利点です。

#### **【次点：堅牢性重視】自然近傍法（Natural Neighbor）**

* **理由:** パラメータ調整が一切不要で、どのようなデータ配置（線状、クラスタ状）であっても安定した結果を返します。補間値が必ず隣接点の範囲内に収まるため、物理的にあり得ない異常値が出るリスクを避けたい場合に最適です。  
* **実装:** metpy.interpolate.natural\_neighbor\_to\_grid や naturalneighbor パッケージ、あるいは離散近似アルゴリズムを用いて実装します。

#### **【計算速度・大規模化視野】多段階Bスプライン（MBA）**

* **理由:** 将来的にデータ数が増える可能性がある場合、あるいはリアルタイムに近い処理速度が求められる場合に適しています。粗い格子から順にフィットさせる仕組みは、疎なデータの穴埋め（Inpainting）としても機能します。  
* **実装:** C++実装（mba ライブラリ）やそのPythonラッパー、あるいは scipy.interpolate.make\_interp\_spline の応用で実現可能です。

#### **【汎用・中庸】修正シェパード法（Modified Quadratic Shepard）**

* **理由:** IDWの欠点を解消しつつ、RBFほどの計算コストをかけたくない場合（中規模データ）のバランスの良い選択肢です。局所的な二次曲面フィットにより、地形のようなデータの補間に適しています。  
* **実装:** 多くのGISソフトウェア（Surfer, ArcGIS）や数値計算ライブラリ（NAG, SHEPPACK）に標準搭載されています。

### **8\. 結論**

「少ないデータでも滑らかに」という難題に対する解は、単純な距離計算（IDW）や線形接続（TIN）からの脱却を要求します。  
数学的な滑らかさと大域的な整合性を最優先するならば Thin Plate Spline RBF が、データの範囲内での安全性と局所的な挙動の自然さを優先するならば 自然近傍法（Natural Neighbor） が、現時点でのベストプラクティスであると結論付けられます。また、計算幾何学的なアプローチとして Powell-Sabinスプライン や RBF-FD といった高度な手法は、単純な補間を超えた数値解析（微分計算など）への応用可能性を秘めており、用途に応じた使い分けが肝要です。

---

参考文献の引用について:  
本報告書内の記述は、以下の資料IDに基づいています。

1

#### **引用文献**

1. Scattered Data Interpolation for Computer Graphics v1.0 \- JP Lewis, 11月 20, 2025にアクセス、 [https://scribblethink.org/Courses/ScatteredInterpolation/scatteredinterpcoursenotes.pdf](https://scribblethink.org/Courses/ScatteredInterpolation/scatteredinterpcoursenotes.pdf)  
2. Interpolating Sparse Scattered Data Using Flow Information \- Computer Science | UC Davis Engineering, 11月 20, 2025にアクセス、 [https://web.cs.ucdavis.edu/\~hamann/StreletzGebbieKreylosHamannKelloggSpero2013JournalOfComputationalSciencePaperRevisionAsAccepted04022016.pdf](https://web.cs.ucdavis.edu/~hamann/StreletzGebbieKreylosHamannKelloggSpero2013JournalOfComputationalSciencePaperRevisionAsAccepted04022016.pdf)  
3. Influence of Different Data Interpolation Methods for Sparse Data on the Construction Accuracy of Electric Bus Driving Cycle \- MDPI, 11月 20, 2025にアクセス、 [https://www.mdpi.com/2079-9292/12/6/1377](https://www.mdpi.com/2079-9292/12/6/1377)  
4. A Survey of Methods for Moving Least Squares Surfaces \- Eurographics Association, 11月 20, 2025にアクセス、 [https://diglib.eg.org/bitstreams/8e911519-ce05-481c-88e2-f0f0a1189844/download](https://diglib.eg.org/bitstreams/8e911519-ce05-481c-88e2-f0f0a1189844/download)  
5. Interpolation methods · DataInterpolations.jl, 11月 20, 2025にアクセス、 [https://docs.sciml.ai/DataInterpolations/stable/methods/](https://docs.sciml.ai/DataInterpolations/stable/methods/)  
6. Scattered Data Interpolation with Multilevel B-Splines \- POSTECH Computer Graphics Laboratory, 11月 20, 2025にアクセス、 [http://cg.postech.ac.kr/papers/scatteredData.pdf](http://cg.postech.ac.kr/papers/scatteredData.pdf)  
7. (PDF) A multivariate Powell–Sabin interpolant \- ResearchGate, 11月 20, 2025にアクセス、 [https://www.researchgate.net/publication/226159404\_A\_multivariate\_Powell-Sabin\_interpolant](https://www.researchgate.net/publication/226159404_A_multivariate_Powell-Sabin_interpolant)  
8. jmespadero/pyDelaunay2D: A simple Delaunay 2D triangulation in python (with numpy), 11月 20, 2025にアクセス、 [https://github.com/jmespadero/pyDelaunay2D](https://github.com/jmespadero/pyDelaunay2D)  
9. Inverse distance weighting \- Wikipedia, 11月 20, 2025にアクセス、 [https://en.wikipedia.org/wiki/Inverse\_distance\_weighting](https://en.wikipedia.org/wiki/Inverse_distance_weighting)  
10. Modified Shepard's Method \- Introduction to Surfer, 11月 20, 2025にアクセス、 [https://surferhelp.goldensoftware.com/griddata/IDD\_GRID\_DATA\_SHEPARDS.htm](https://surferhelp.goldensoftware.com/griddata/IDD_GRID_DATA_SHEPARDS.htm)  
11. Surface and Field Analysis \> Deterministic Interpolation Methods \> Modified Shepard, 11月 20, 2025にアクセス、 [https://www.spatialanalysisonline.com/HTML/modified\_shepard.htm](https://www.spatialanalysisonline.com/HTML/modified_shepard.htm)  
12. Constrained Modi ed Quadratic Shepard Method for One-dimensional Interpolation \- Faculty of Engineering and Physical Sciences \- University of Leeds, 11月 20, 2025にアクセス、 [https://institutes.engineering.leeds.ac.uk/computing/research/publications/reports/1999/1999\_19.pdf](https://institutes.engineering.leeds.ac.uk/computing/research/publications/reports/1999/1999_19.pdf)  
13. Shepard and Hardy Multiquadric Interpolation Methods for Multicomponent Aerosol–Cloud Parameterization in \- AMS Journals, 11月 20, 2025にアクセス、 [https://journals.ametsoc.org/view/journals/atsc/66/1/2008jas2626.1.xml](https://journals.ametsoc.org/view/journals/atsc/66/1/2008jas2626.1.xml)  
14. MULTISCALE MODIFICATION OF SHEPARD'S METHOD FOR MULTIVARIATE INTERPOLATION OF SCATTERED DATA, 11月 20, 2025にアクセス、 [http://www.techmat.vgtu.lt/\~art/proc/file/MasjVl.pdf](http://www.techmat.vgtu.lt/~art/proc/file/MasjVl.pdf)  
15. Origin Help \- Gridding Methods for Randomly Spaced Data \- OriginLab, 11月 20, 2025にアクセス、 [https://www.originlab.com/doc/Origin-Help/GridMethod-RandomSpaced](https://www.originlab.com/doc/Origin-Help/GridMethod-RandomSpaced)  
16. Scattered data interpolation by Shepard's like methods: classical results and recent advances, 11月 20, 2025にアクセス、 [http://ftp.gwdg.de/pub/misc/EMIS/journals/DRNA/pdf/dellaccioditommaso\_kmfa2016.pdf](http://ftp.gwdg.de/pub/misc/EMIS/journals/DRNA/pdf/dellaccioditommaso_kmfa2016.pdf)  
17. SHEPPACK: Modified Shepard Algorithm for Interpolation of Scattered Multivariate Data \- Computer Science Technical Reports, 11月 20, 2025にアクセス、 [https://eprints.cs.vt.edu/archive/00001077/01/sheppack.pdf](https://eprints.cs.vt.edu/archive/00001077/01/sheppack.pdf)  
18. Comparing Performance of Inverse Distance Weighting and Modified Shepa, 11月 20, 2025にアクセス、 [https://www.taylorfrancis.com/chapters/edit/10.1201/9781003224624-18/comparing-performance-inverse-distance-weighting-modified-shepard-interpolation-models-different-sampling-arrangements-dheera-kalota-mohammad-firoz-khan](https://www.taylorfrancis.com/chapters/edit/10.1201/9781003224624-18/comparing-performance-inverse-distance-weighting-modified-shepard-interpolation-models-different-sampling-arrangements-dheera-kalota-mohammad-firoz-khan)  
19. 11月 20, 2025にアクセス、 [https://surferhelp.goldensoftware.com/griddata/IDD\_GRID\_DATA\_SHEPARDS.htm\#:\~:text=Modified%20Shepard's%20Method%20uses%20an,appearance%20of%20the%20generated%20contours.](https://surferhelp.goldensoftware.com/griddata/IDD_GRID_DATA_SHEPARDS.htm#:~:text=Modified%20Shepard's%20Method%20uses%20an,appearance%20of%20the%20generated%20contours.)  
20. naginterfaces.library.interp.dimn\_scat\_shep \- NAG Technical Support Service, 11月 20, 2025にアクセス、 [https://support.nag.com/numeric/py/nagdoc\_latest/naginterfaces.library.interp.dimn\_scat\_shep.html](https://support.nag.com/numeric/py/nagdoc_latest/naginterfaces.library.interp.dimn_scat_shep.html)  
21. How Natural Neighbor works—ArcGIS Pro | Documentation, 11月 20, 2025にアクセス、 [https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-analyst/how-natural-neighbor-works.htm](https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-analyst/how-natural-neighbor-works.htm)  
22. Natural-neighbor interpolation \- Wikipedia, 11月 20, 2025にアクセス、 [https://en.wikipedia.org/wiki/Natural-neighbor\_interpolation](https://en.wikipedia.org/wiki/Natural-neighbor_interpolation)  
23. A Fast Algorithm for Natural Neighbor Interpolation, 11月 20, 2025にアクセス、 [https://gwlucastrig.github.io/TinfourDocs/NaturalNeighborTinfourAlgorithm/index.html](https://gwlucastrig.github.io/TinfourDocs/NaturalNeighborTinfourAlgorithm/index.html)  
24. Comparing interpolation methods—ArcGIS Pro | Documentation, 11月 20, 2025にアクセス、 [https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-analyst/comparing-interpolation-methods.htm](https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-analyst/comparing-interpolation-methods.htm)  
25. Sibson vs Laplace interpolations \[19\]. | Download Scientific Diagram \- ResearchGate, 11月 20, 2025にアクセス、 [https://www.researchgate.net/figure/Sibson-vs-Laplace-interpolations-19\_fig4\_227536726](https://www.researchgate.net/figure/Sibson-vs-Laplace-interpolations-19_fig4_227536726)  
26. Natural Neighbor Concepts in Scattered Data Interpolation and Discrete Function Approximation, 11月 20, 2025にアクセス、 [https://www-home.htwg-konstanz.de/\~umlauf/Papers/Bobach.IRTG07.pdf](https://www-home.htwg-konstanz.de/~umlauf/Papers/Bobach.IRTG07.pdf)  
27. Natural Neighbor Interpolation \- Critical Assessment and New Contributions \- kluedo, 11月 20, 2025にアクセス、 [https://kluedo.ub.rptu.de/frontdoor/deliver/index/docId/2104/file/diss.bobach.natural.neighbor.20090615.pdf](https://kluedo.ub.rptu.de/frontdoor/deliver/index/docId/2104/file/diss.bobach.natural.neighbor.20090615.pdf)  
28. Fast, discrete natural neighbor interpolation in 3D on the CPU. \- GitHub, 11月 20, 2025にアクセス、 [https://github.com/innolitics/natural-neighbor-interpolation](https://github.com/innolitics/natural-neighbor-interpolation)  
29. Discrete Sibson Interpolation \- Computer Science | UC Davis Engineering, 11月 20, 2025にアクセス、 [https://web.cs.ucdavis.edu/\~hamann/ParkLinsenKreylosOwensHamann2005FinalFinalFinalFinal.pdf](https://web.cs.ucdavis.edu/~hamann/ParkLinsenKreylosOwensHamann2005FinalFinalFinalFinal.pdf)  
30. Discrete Sibson Interpolation / Fabian Iwand \- Observable, 11月 20, 2025にアクセス、 [https://observablehq.com/@mootari/sibson-interpolation](https://observablehq.com/@mootari/sibson-interpolation)  
31. On the role of polynomials in RBF-FD approximations: I. Interpolation and accuracy \- University of Colorado Boulder, 11月 20, 2025にアクセス、 [https://www.colorado.edu/amath/sites/default/files/attached-files/2016\_ffbb\_rbf-fd\_i\_interpolation\_jcp\_submitted.pdf](https://www.colorado.edu/amath/sites/default/files/attached-files/2016_ffbb_rbf-fd_i_interpolation_jcp_submitted.pdf)  
32. RBF-FD discretization of the Navier-Stokes equations using scattered but staggered nodes, 11月 20, 2025にアクセス、 [https://flowphysics.ucsd.edu/wp-content/papercite-data/pdf/chuschmidt\_2022\_jcp.pdf](https://flowphysics.ucsd.edu/wp-content/papercite-data/pdf/chuschmidt_2022_jcp.pdf)  
33. Radial Basis Function Generated Finite Differences (RBF-FD): New Computational Opportunities for Solving PDEs Natasha Flyer \- University of Colorado Boulder, 11月 20, 2025にアクセス、 [https://www.colorado.edu/amath/sites/default/files/attached-files/2015\_oxford.pdf](https://www.colorado.edu/amath/sites/default/files/attached-files/2015_oxford.pdf)  
34. A Radial Basis Function (RBF)-Finite Difference (FD) Method for Diffusion and Reaction-Diffusion Equations on Surfaces \- PMC \- NIH, 11月 20, 2025にアクセス、 [https://pmc.ncbi.nlm.nih.gov/articles/PMC4428618/](https://pmc.ncbi.nlm.nih.gov/articles/PMC4428618/)  
35. Scattered Node Compact Finite Difference-Type Formulas Generated from Radial Basis Functions \- Grady Wright, 11月 20, 2025にアクセス、 [https://gradywright.github.io/papers/rbf\_fd\_hfd.pdf](https://gradywright.github.io/papers/rbf_fd_hfd.pdf)  
36. A Numerical Study of Combining RBF Interpolation and Finite Differences to Approximate Differential Operators \- arXiv, 11月 20, 2025にアクセス、 [https://arxiv.org/html/2505.14232v1](https://arxiv.org/html/2505.14232v1)  
37. Enhancing finite differences with radial basis functions: Experiments on the Navier-Stokes equations \- the NOAA Institutional Repository, 11月 20, 2025にアクセス、 [https://repository.library.noaa.gov/view/noaa/32620/noaa\_32620\_DS1.pdf](https://repository.library.noaa.gov/view/noaa/32620/noaa_32620_DS1.pdf)  
38. Some observations regarding the RBF-FD approximation accuracy dependence on stencil size \- arXiv, 11月 20, 2025にアクセス、 [https://arxiv.org/html/2404.03793v1](https://arxiv.org/html/2404.03793v1)  
39. Robust Moving Least-squares Fitting with Sharp Features \- Scientific Computing and Imaging Institute, 11月 20, 2025にアクセス、 [https://www.sci.utah.edu/\~shachar/Publications/rmls.pdf](https://www.sci.utah.edu/~shachar/Publications/rmls.pdf)  
40. Image Deformation Using Moving Least Squares \- Texas A\&M University, 11月 20, 2025にアクセス、 [https://people.engr.tamu.edu/schaefer/research/mls.pdf](https://people.engr.tamu.edu/schaefer/research/mls.pdf)  
41. A Dimension Splitting-Interpolating Moving Least Squares (DS-IMLS) Method with Nonsingular Weight Functions \- MDPI, 11月 20, 2025にアクセス、 [https://www.mdpi.com/2227-7390/9/19/2424](https://www.mdpi.com/2227-7390/9/19/2424)  
42. New concepts for moving least squares: An interpolating non-singular weighting function and weighted nodal least squares \- ResearchGate, 11月 20, 2025にアクセス、 [https://www.researchgate.net/publication/222581845\_New\_concepts\_for\_moving\_least\_squares\_An\_interpolating\_non-singular\_weighting\_function\_and\_weighted\_nodal\_least\_squares](https://www.researchgate.net/publication/222581845_New_concepts_for_moving_least_squares_An_interpolating_non-singular_weighting_function_and_weighted_nodal_least_squares)  
43. Building Interpolating and Approximating Implicit Surfaces Using Moving Least Squares \- UC Berkeley EECS, 11月 20, 2025にアクセス、 [https://www2.eecs.berkeley.edu/Pubs/TechRpts/2007/EECS-2007-14.pdf](https://www2.eecs.berkeley.edu/Pubs/TechRpts/2007/EECS-2007-14.pdf)  
44. Provably Good Moving Least Squares, 11月 20, 2025にアクセス、 [https://www.cs.jhu.edu/\~misha/Fall13b/Papers/Kolluri05.pdf](https://www.cs.jhu.edu/~misha/Fall13b/Papers/Kolluri05.pdf)  
45. An efficient scattered data approximation using multilevel B-splines based on quasi-interpolants \- IEEE Xplore, 11月 20, 2025にアクセス、 [https://ieeexplore.ieee.org/document/1443235/](https://ieeexplore.ieee.org/document/1443235/)  
46. Approximation of Scattered Data with Multilevel B-splines \- SINTEF, 11月 20, 2025にアクセス、 [https://www.sintef.no/globalassets/upload/ikt/9011/geometri/mba/mba.pdf](https://www.sintef.no/globalassets/upload/ikt/9011/geometri/mba/mba.pdf)  
47. Scattered data interpolation with multilevel B-splines \- IEEE Xplore, 11月 20, 2025にアクセス、 [https://ieeexplore.ieee.org/document/620490](https://ieeexplore.ieee.org/document/620490)  
48. Examples of multilevel B-spline approximation under different... \- ResearchGate, 11月 20, 2025にアクセス、 [https://www.researchgate.net/figure/Examples-of-multilevel-B-spline-approximation-under-different-resolutions-for-the\_fig4\_3410822](https://www.researchgate.net/figure/Examples-of-multilevel-B-spline-approximation-under-different-resolutions-for-the_fig4_3410822)  
49. Scattered Data Interpolation Using an Alternate Differential Equation Interpolant by Gonzalo A. Ramos A thesis submitted in conf \- Dynamic Graphics Project, 11月 20, 2025にアクセス、 [https://www.dgp.toronto.edu/\~bonzo/docs/MyThesis.pdf](https://www.dgp.toronto.edu/~bonzo/docs/MyThesis.pdf)  
50. CloughTocher2DInterpolator — SciPy v1.16.2 Manual, 11月 20, 2025にアクセス、 [https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.CloughTocher2DInterpolator.html](https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.CloughTocher2DInterpolator.html)  
51. Quasi-Interpolation in a Space of C 2 Sextic Splines over Powell–Sabin Triangulations, 11月 20, 2025にアクセス、 [https://www.mdpi.com/2227-7390/9/18/2276](https://www.mdpi.com/2227-7390/9/18/2276)  
52. A Powell-Sabin finite element scheme for partial differential equations \- ESAIM: Proceedings and Surveys, 11月 20, 2025にアクセス、 [https://www.esaim-proc.org/articles/proc/pdf/2016/01/proc165305.pdf](https://www.esaim-proc.org/articles/proc/pdf/2016/01/proc165305.pdf)  
53. Smooth Macro-Elements on Powell-Sabin-12 Splits \- Department of Mathematics, 11月 20, 2025にアクセス、 [https://math.vanderbilt.edu/schumake/ps12.pdf](https://math.vanderbilt.edu/schumake/ps12.pdf)  
54. Scattered data interpolation (griddata) — SciPy v1.16.2 Manual, 11月 20, 2025にアクセス、 [https://docs.scipy.org/doc/scipy/tutorial/interpolate/ND\_unstructured.html](https://docs.scipy.org/doc/scipy/tutorial/interpolate/ND_unstructured.html)  
55. Spatial Interpolation Methods, 11月 20, 2025にアクセス、 [https://iri.columbia.edu/\~rijaf/CDTUserGuide/html/interpolation\_methods.html](https://iri.columbia.edu/~rijaf/CDTUserGuide/html/interpolation_methods.html)  
56. (PDF) Scattered Data Interpolation with Multilevel B-Splines \- ResearchGate, 11月 20, 2025にアクセス、 [https://www.researchgate.net/publication/3410822\_Scattered\_Data\_Interpolation\_with\_Multilevel\_B-Splines](https://www.researchgate.net/publication/3410822_Scattered_Data_Interpolation_with_Multilevel_B-Splines)  
57. CGAL 6.1 \- 2D Generalized Barycentric Coordinates: User Manual, 11月 20, 2025にアクセス、 [https://doc.cgal.org/latest/Barycentric\_coordinates\_2/index.html](https://doc.cgal.org/latest/Barycentric_coordinates_2/index.html)  
58. Generalized Barycentric Interpolation | Università della Svizzera italiana \- USI Search, 11月 20, 2025にアクセス、 [https://search.usi.ch/en/projects/676/generalized-barycentric-interpolation](https://search.usi.ch/en/projects/676/generalized-barycentric-interpolation)